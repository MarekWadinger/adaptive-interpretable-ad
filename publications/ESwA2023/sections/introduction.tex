Anomaly detection systems play a critical role in risk-averse systems by identifying abnormal patterns and adapting to novel expected patterns in data. These systems are particularly vital in the context of Internet of Things (IoT) devices that continuously stream high-fidelity data to control units.

In this rapidly evolving field with long-spanning roots, Chandola et al. conducted an influential review of prior research efforts across diverse application domains (\cite{Chandola2009}).
Recent studies have underscored the need for holistic and tunable anomaly detection methods accessible to operators (\cite{Laptev2015, Kejariwal2015, Cook2020}).

Cook et al. denote substantial aspects that pose challenges to anomaly detection in IoT, including the temporal, spatial, and external context of measurements, multivariate characteristics, noise, and nonstationarity (\cite{Cook2020}). To address these complexities, Zhang et al. have successfully employed spatially distributed sensors and time-relative modulation. Their approach has proven effective, particularly in the context of complex non-linear systems, offering potential solutions to some of the challenges posed by IoT data (\cite{ZHANG2024121506}). Huang et al., on the other hand, tackled the problems of detecting global outliers, local outliers, and outlier clusters simultaneously. Their proposed approach, based on density estimation, relies on the notion that density distributions should exhibit minimal variations in local areas. To achieve this, they introduce a novel turning ratio metric, which reduces reliance on hyperparameters and enhances anomaly detection (\cite{HUANG2023120799}).

Additionally, feature engineering techniques play a crucial role in capturing contextual properties and enhancing anomaly detection performance (\cite{Fan2019}). However, it's worth noting that feature engineering may introduce categorical variables and significantly increase dimensionality of the data, requiring specific methods for handling large data, sizeable data storage, and substantial computational resources (\cite{Talagala2021}). Recently, Li et al. introduced an attribute-weighted outlier detection algorithm, designed for high-dimensional datasets with mixtures of categorical and numerical data. Their approach assigns different weights to individual attributes based on their importance in anomaly detection and uses these weights to calculate distances between data points. Notably, Li et al. demonstrated the superior performance of their algorithm compared to state-of-the-art methods (\cite{LI2024121304}). Another strategy for handling high-dimensional data involves using deep learning methods with synthetic normal data to enhance the detection of outliers with subtle deviations, as proposed in \cite{DU2024121161}.

Nevertheless, the presence of nonstationarity, often stemming from concept drift (a shift in data patterns due to changes in statistical distribution) and change points (permanent alterations in system state), presents a substantial challenge (\cite{Salehi2018}). In practical scenarios, those changes tend to be unpredictable in both their spatial and temporal aspects.Consequently, they require systems with solid outlier rejection capabilities of intelligent tracking algorithms (\cite{Barbosa2019162}). This underscores the critical importance of an anomaly detection method's ability to adapt to evolving data structures, especially in long-term deployments. Nevertheless, as (\cite{Tartakovsky2013}) remarked, the immediate detection is not a feasible option unless there is a high tolerance for false alarms.

The former scalability problem now introduces a significant latency in detector adaptation (\cite{Wu2021}). Incremental learning methods allowed adaptation while restraining the storage of the whole dataset. The supervised operator-in-the-loop solution offered by Pannu et al. showed the detector's adaptation to data labeled on the flight (\cite{Pannu2012}).
Others approached the problem as sequential processing of bounded data buffers in univariate signals (\cite{Ahmad2017134}) and multivariate systems (\cite{Bosman201514}).

\subsection{Related Work}
Recent advances in anomaly detection have broadened its scope to include root cause identification governed by the development of explanatory methods capable of diagnosing and tracking faults across the system. Studies can be split into two groups of distinct approaches. The first group approaches explainability as the importance of individual features (\cite{Carletti2019, Nguyen2019, Amarasinghe2018}). Those studies allow an explanation of novelty by considering features independently. The second group uses statistical learning creating models explainable via probability. For instance, integration of variational Bayesian inference probabilistic graph neural network allowed Zhang et al. to model the posterior distribution of sensor dependency for gas leakage localization on unlabeled data (\cite{ZHANG2023120542}). Yang et al. recently proposed a Bayesian network (BN) for fault detection and diagnosis. In this BN, individual nodes of the network represent normally distributed variables, whereas the multiple regression model defines weights and relationships. Using the predefined structure of the BN, the authors propose an offline training with online detection and diagnosis (\cite{Yang2022}).

Given the infrequent occurrence of anomalies and their potential absence in training data, the incorporation of synthetic data or feature extraction for various detected events emerges to assist diagnosis of the system. Brito et al. designed synthetic faults based on expert knowledge and introduced them into a transfer learning classifier to exploit faults in rotating machinery, with a subsequent explanation layer (\cite{BRITO2023120860}). Conversely, We et al. leveraged feature selection to expose various types of abnormal behavior. The team presents competetive performance while using change in relationships to provide causal inference (\cite{WU2024121539}).

However, it is crucial to underscore that offline training, as previously emphasized, is inherently inadequate when it comes to adapting to anticipated novel patterns, rendering it unsuitable for sustained, long-term operation on  IoT devices.

This paper emphasizes the importance of combining adaptability in interpretable anomaly detection and proposes a method that addresses this challenge. Here we report the discovery and characterization of an adaptive anomaly detection method for streaming IoT data. The ability to diagnose multivariate data while providing root cause isolation, inherent in the univariate case, extends our previous contribution to the field as presented in (\cite{Wadinger2023}). The proposed algorithm represents a general method for a broad range of safety-critical systems where anomaly diagnosis and identification are paramount.

\subsection{Novelty of proposed approach}
The idea of using statistical outlier detection is well-established. We highlighting impactful contributions of (\cite{Yamanishi2002}) and (\cite{Yamanishi2004}). The authors propose a method for detecting anomalies in a time series. The method is based on the assumption that the continuous data is generated by a mixture of Gaussian distributions, while discrete data is modeled as histogram density. The authors solve the problem of change point detection as well. However, the adaptation system is unaware of such changes, making the moving window the only source of adaptation. Our self-supervised approach offers intelligent adaptation w.r.t. detected change points. Moreover, the author of the study does not attempt to isolate the root cause of the anomaly. We do so by computing the conditional probability of each measurement given the rest of the measurements and drawing limits defining the normal event probability threshold.

A limited number of studies have focused on adaptation and interpretability within the framework of anomaly detection. Two recent contributions in this area are (\cite{Steenwinckel2018}) and (\cite{Steenwinckel2021}). In (\cite{Steenwinckel2018}), the authors emphasize the importance of combining prior knowledge with a data-driven approach to achieve interpretability, particularly concerning root cause isolation. They propose a novel approach that involves extracting features based on knowledge graph pattern extraction and integrating them into the anomaly detection mechanism. This graph is subsequently transformed into a matrix, and adaptive region-of-interest extraction is performed using reinforcement learning techniques. To enhance interpretability, a Generative Adversarial Network (GAN) reconstructs a new graphical representation based on selected vectors. However, it's important to note that the validation of this idealized approach is pending further investigation. Lately, (\cite{Steenwinckel2021}) introduced a comprehensive framework for adaptive anomaly detection and root cause analysis in data streams. While the adaptation process is driven by user feedback, the specific mechanism remains undisclosed. The authors present an interpretation of their method through a user dashboard, featuring visualizations of raw data. This dashboard is capable of distinguishing between track-related problems and train-related issues, based on whether multiple trains at the same geographical location approach the anomaly. Meanwhile, our attempts aim to develop a self-supervised method capable of learning without human supervision which is often limited in time and poses significant delays in adaptation, while interpretation offers straightforward statistical reasoning and root cause isolation.

\subsection{Validation}\label{par:validation}
Two case studies show that our proposed method, based on dynamic joint normal distribution, has the capacity to explain novelties, isolate the root cause of anomalies, and allow adaptation to change points, advancing recently developed anomaly detection techniques for long-term deployment and cross-domain usage. We observe similar detection performance, albeit with lower scalability, on benchmark data when comparing our approach to well-established unsupervised anomaly detection methods in streamed data which create a bedrock for many state-of-the-art contributions, such as One-Class SVM (\cite{Amer2013, Liu2014, Krawczyk2015, Miao2019, Gozuacik2021}), and Half-Space Trees (\cite{Wetzig2019, Lyu2020}).

\subsection{Broader Impact}
Potential applications of the proposed method are in the field of energy storage systems, where the ability to detect anomalies and isolate their root cause, whilst adapting to changes in operation and environment, is crucial for the safety of the system. The proposed method is suitable for the existing infrastructure of the system, allowing detection and diagnosis of the system based on existing data streams. The dynamic process limits allow operational metrics monitoring, making potential early detection and prevention easier. Using adaptable methods without interpretability, on the other hand, may pose safety risks and lower total financial benefits, as the triggered false alarms may need to be thoroughly analyzed, resulting in prolonged downtimes.

The main contribution of the proposed solution to the developed body of research is that it:
\begin{itemize}
\item Enriches interpretable anomaly detection with adaptive capabilities
\item Isolates root cause of anomalies while considering interactions
\item Uses self-learning approach on streamed IoT data
\item Demonstrates interpretability by providing process limits for signals
\item Utilizes existing IT infrastructure
\end{itemize}

\subsection{Paper Organization}
The rest of the paper is structured as follows: We begin with the problem and motivation in \textbf{Section~\ref{Introduction}}, providing context. Next, in \textbf{Section~\ref{Preliminaries}}, we lay the theoretical groundwork. Our proposed adaptive anomaly detection method is detailed in \textbf{Section~\ref{Proposed Method}}. We then demonstrate real-world applications in \textbf{Section~\ref{Case Study}}. Finally, we conclude the paper in \textbf{Section~\ref{Conclusion}}, summarizing findings and discussing future research directions.
